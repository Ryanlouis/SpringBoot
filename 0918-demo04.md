# 0918 Practice - Demo03

### 

```java
ExplainDIRunner3.java (NEW)

package com.example.demo3.runner;

import com.example.demo3.calculator.AddCalculator;
import com.example.demo3.calculator.Calculator;
import lombok.extern.slf4j.Slf4j;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.CommandLineRunner;
import org.springframework.core.annotation.Order;
import org.springframework.stereotype.Component;

@Component
@Slf4j
@Order(3)
public class ExplainDIRunner3 implements CommandLineRunner {
    @Autowired
    private Calculator cal1;


    @Override
    public void run(String... args) throws Exception {
        log.info("will append at last");
        log.info("calculate 5,6 with cal1={}", cal1.calc(5, 6));
    }
}
```

```java
Foo1.java (NEW)

package com.example.demo3.explain;

import com.example.demo3.calculator.Calculator;
import lombok.AllArgsConstructor;
import lombok.Getter;
import lombok.NoArgsConstructor;

@Getter
@NoArgsConstructor
@AllArgsConstructor
public class Foo1 {
    private int x;
    private Calculator c; // y is important, maybe can be initialized from foo1 constructor
    private int z;

    public Foo1(Calculator c) {
        this.c = c;
    }
}
```

```java
Foo2.java (NEW)

package com.example.demo3.explain;

import com.example.demo3.calculator.Calculator;
import lombok.Getter;
@Getter
public class Foo2 {
    private int x;
    private final Calculator c; // y is important, maybe can be initialized from foo1 constructor
    private int z;


    public Foo2(Calculator c) {
        this.c = c;
    }
}
```

```java
Foo3.java (NEW)

package com.example.demo3.explain;

import com.example.demo3.calculator.Calculator;
import lombok.RequiredArgsConstructor;
import lombok.Getter;
@RequiredArgsConstructor
@Getter
public class Foo3 {
    private int x;
    private final Calculator c; // y is important, maybe can be initialized from foo1 constructor
    private int z;
}
```

```java
ArgumentsTest.java (NEW src/test/java)

package com.example.demo3;

import com.example.demo3.calculator.AddCalculator;
import com.example.demo3.calculator.SubCalculator;
import com.example.demo3.explain.Foo1;
import com.example.demo3.explain.Foo2;
import com.example.demo3.explain.Foo3;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;

public class ArgumentsTest {
    @Test
    public void initializeFoo1() {
        Foo1 foo1 = new Foo1();
        Assertions.assertNull(foo1.getC());

    }

    @Test
    public void initializeFoo2() {
        Foo2 foo2 = new Foo2(new SubCalculator());
        Assertions.assertEquals(2, foo2.getC().calc(4, 2));
    }

    @Test
    public void initializeFoo3() {
        Foo3 foo3 = new Foo3(new AddCalculator());
        Assertions.assertEquals(6, foo3.getC().calc(4, 2));
    }
}
```
<img width="634" height="202" alt="{F07AB8FE-3A9E-40AB-8289-9655619D2E23}" src="https://github.com/user-attachments/assets/986e41ed-8a1d-49ae-9f34-d7f046fd4b46" />

### 應該是在說 @Component

```java
Racing.java (NEW)

package com.example.demo3.race;

public interface Racing {
    public String status();
}
```

```java
Bicycle.java (NEW)

package com.example.demo3.race;

import org.springframework.stereotype.Component;

@Component
public class Bicycle implements Racing {
    @Override
    public String status() {
        return "2km/min";
    }
}
```

```java
ExplainDIRunner4.java (NEW)

package com.example.demo3.runner;

import com.example.demo3.race.Bicycle;
import com.example.demo3.race.Racing;
import lombok.extern.slf4j.Slf4j;
import org.springframework.boot.CommandLineRunner;
import org.springframework.context.ApplicationContext;
import org.springframework.core.annotation.Order;
import org.springframework.stereotype.Component;

@Component
@Slf4j
@Order(4)
public class ExplainDIRunner4 implements CommandLineRunner {
    public ExplainDIRunner4(ApplicationContext context) {
        this.context = context;
    }

    private ApplicationContext context;

    @Override
    public void run(String... args) throws Exception {
        Racing r1 = context.getBean(Racing.class);
        log.info("r1={}", r1.status());
        Bicycle b1 = context.getBean(Bicycle.class);
        log.info("b1={}", b1.status());
    }
}

```

```java
ExplainDIRunner5.java (NEW)

package com.example.demo3.runner;

import com.example.demo3.race.Bicycle;
import com.example.demo3.race.Racing;
import lombok.extern.slf4j.Slf4j;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.CommandLineRunner;
import org.springframework.core.annotation.Order;
import org.springframework.stereotype.Component;

@Component
@Slf4j
@Order(5)
public class ExplainDIRunner5 implements CommandLineRunner {
    @Autowired
    private Racing r1;
    @Autowired
    private Bicycle b1;

    @Override
    public void run(String... args) throws Exception {
        log.info("r1={}", r1.status());
        log.info("b1={}", b1.status());
    }
}
```

### Logging

```java
ExplainLog.java (NEW)

package com.example.demo3.runner;

import lombok.extern.slf4j.Slf4j;
import org.springframework.boot.CommandLineRunner;
import org.springframework.core.annotation.Order;
import org.springframework.stereotype.Component;

@Component
@Slf4j
@Order(6)
public class ExplainLog implements CommandLineRunner {
    @Override
    public void run(String... args) throws Exception {
        log.trace("this is a log");
        log.debug("this is a log");
        log.info("this is a log");
        log.warn("this is a log");
        log.error("this is a log");
    }
}
```

```properties
application.properties

spring.application.name=demo3
management.endpoints.web.exposure.include=*
#logging.level.root=trace
logging.level.root=info
logging.level.com.example.demo3.runner.ExplainLog=trace
```

<img width="1114" height="173" alt="{82AE7211-1AEA-43E5-B317-0C14B79ABB41}" src="https://github.com/user-attachments/assets/035d624f-fee3-4da8-9e1d-476dd30366d9" />


參考連結 https://docs.spring.io/spring-boot/docs/3.2.2/reference/htmlsingle/

### Bean name

```java
AppConfig .java

package com.example.demo3.config;

import com.example.demo3.calculator.AddCalculator;
import com.example.demo3.calculator.Calculator;
import com.example.demo3.calculator.SubCalculator;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

@Configuration
public class AppConfig {
    @Bean(name = "add")
    public Calculator cal1() {
        return new AddCalculator();
    }

    @Bean(name = "sub")
    public Calculator cal2() {
        return new SubCalculator();
    }
}
```

```java
ExplainDIRunner1.java

package com.example.demo3.runner;

import com.example.demo3.calculator.Calculator;
import lombok.extern.slf4j.Slf4j;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.CommandLineRunner;
import org.springframework.context.ApplicationContext;
import org.springframework.core.annotation.Order;
import org.springframework.stereotype.Component;

@Component
@Slf4j
@Order(1)
public class ExplainDIRunner1 implements CommandLineRunner {
    @Autowired
    private ApplicationContext context;

    @Override
    public void run(String... args) throws Exception {
        Calculator c1 = context.getBean("add", Calculator.class);
        log.info("c1 with 1,2={}", c1.calc(1, 2));
        Calculator c2 = context.getBean("sub", Calculator.class);
        log.info("c2 with 1,2={}", c2.calc(1, 2));
    }
}
```

```java
ExplainDIRunner2.java

package com.example.demo3.runner;

import com.example.demo3.calculator.Calculator;
import lombok.extern.slf4j.Slf4j;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.boot.CommandLineRunner;
import org.springframework.core.annotation.Order;
import org.springframework.stereotype.Component;

@Component
@Slf4j
@Order(2)
public class ExplainDIRunner2 implements CommandLineRunner {

    private final Calculator cal1;
    private final Calculator cal2;

    public ExplainDIRunner2(@Qualifier("add") Calculator cal1,
                            @Qualifier("sub") Calculator cal2) {
        this.cal1 = cal1;
        this.cal2 = cal2;
    }

    @Override
    public void run(String... args) throws Exception {
        log.info("calculate 3,4 with cal1={}", cal1.calc(3, 4));
        log.info("calculate 3,4 with cal2={}", cal2.calc(3, 4));
    }
}
```

```java
ExplainDIRunner3.java

package com.example.demo3.runner;

import com.example.demo3.calculator.AddCalculator;
import com.example.demo3.calculator.Calculator;
import lombok.extern.slf4j.Slf4j;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.boot.CommandLineRunner;
import org.springframework.core.annotation.Order;
import org.springframework.stereotype.Component;

@Component
@Slf4j
@Order(3)
public class ExplainDIRunner3 implements CommandLineRunner {
    @Autowired
    @Qualifier("add")
    private Calculator cal1;
    @Autowired
    @Qualifier("sub")
    private Calculator cal2;


    @Override
    public void run(String... args) throws Exception {

        log.info("calculate 5,6 with cal1={}", cal1.calc(5, 6));
        log.info("calculate 5,6 with cal2={}", cal2.calc(5, 6));
    }
}
```

### @Component 多元件定義

```java
Bike.java (NEW)

package com.example.demo3.race;

import org.springframework.stereotype.Component;

@Component("bike")
public class Bike implements Racing{
    @Override
    public String status() {
        return "80km/hr";
    }
}
```

```java
Bicycle.java

package com.example.demo3.race;

import org.springframework.stereotype.Component;

@Component("bicycle")
public class Bicycle implements Racing {
    @Override
    public String status() {
        return "2km/min";
    }
}
```

```java
ExplainDIRunner4.java

package com.example.demo3.runner;

import com.example.demo3.race.Bicycle;
import com.example.demo3.race.Bike;
import com.example.demo3.race.Racing;
import lombok.extern.slf4j.Slf4j;
import org.springframework.boot.CommandLineRunner;
import org.springframework.context.ApplicationContext;
import org.springframework.core.annotation.Order;
import org.springframework.stereotype.Component;

@Component
@Slf4j
@Order(4)
public class ExplainDIRunner4 implements CommandLineRunner {
    public ExplainDIRunner4(ApplicationContext context) {
        this.context = context;
    }

    private ApplicationContext context;

    @Override
    public void run(String... args) throws Exception {
        Racing r1 = context.getBean("bicycle", Racing.class);
        log.info("r1={}", r1.status());
        Bicycle b1 = context.getBean(Bicycle.class);
        log.info("b1={}", b1.status());
        Racing r2 = context.getBean("bike", Racing.class);
        log.info("r2={}", r2.status());
        Bike b2 = context.getBean(Bike.class);
        log.info("b2={}", b2.status());
    }
}
```

```java
ExplainDIRunner5.java

package com.example.demo3.runner;

import com.example.demo3.race.Bicycle;
import com.example.demo3.race.Bike;
import com.example.demo3.race.Racing;
import lombok.extern.slf4j.Slf4j;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.boot.CommandLineRunner;
import org.springframework.core.annotation.Order;
import org.springframework.stereotype.Component;

@Component
@Slf4j
@Order(5)
public class ExplainDIRunner5 implements CommandLineRunner {
    @Autowired
    @Qualifier("bicycle")
    private Racing r1;
    @Autowired
    @Qualifier("bike")
    private Racing r2;
    @Autowired
    private Bicycle b1;
    @Autowired
    private Bike b2;

    @Override
    public void run(String... args) throws Exception {
        log.info("r1={}", r1.status());
        log.info("b1={}", b1.status());
        log.info("r2={}", r2.status());
        log.info("b2={}", b2.status());
    }
}
```

```java
ExplainDIRunner6.java

package com.example.demo3.runner;

import com.example.demo3.race.Bicycle;
import com.example.demo3.race.Bike;
import com.example.demo3.race.Racing;
import lombok.extern.slf4j.Slf4j;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.boot.CommandLineRunner;
import org.springframework.core.annotation.Order;
import org.springframework.stereotype.Component;

@Component
@Slf4j
@Order(6)
public class ExplainDIRunner6 implements CommandLineRunner {
    public ExplainDIRunner6(@Qualifier("bicycle") Racing r1, @Qualifier("bike") Racing r2) {
        this.r1 = r1;
        this.r2 = r2;
        this.b1 = (Bicycle) r1;
        this.b2 = (Bike) r2;
    }

    private final Racing r1;
    private final Racing r2;
    private final Bicycle b1;
    private final Bike b2;

    @Override
    public void run(String... args) throws Exception {
        log.info("r1={}", r1.status());
        log.info("b1={}", b1.status());
        log.info("r2={}", r2.status());
        log.info("b2={}", b2.status());
    }
}
```

```java
ExplainDIRunner7.java

package com.example.demo3.runner;

import com.example.demo3.race.Bicycle;
import com.example.demo3.race.Bike;
import com.example.demo3.race.Racing;
import lombok.extern.slf4j.Slf4j;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.boot.CommandLineRunner;
import org.springframework.core.annotation.Order;
import org.springframework.stereotype.Component;

@Component
@Slf4j
@Order(7)
public class ExplainDIRunner7 implements CommandLineRunner {
    public ExplainDIRunner7(Bicycle b1, Bike b2) {
        this.r1 = b1;
        this.r2 = b2;
        this.b1 = b1;
        this.b2 = b2;
    }

    private final Racing r1;//bicycle
    private final Racing r2;//bike
    private final Bicycle b1;
    private final Bike b2;

    @Override
    public void run(String... args) throws Exception {
        log.info("r1={}", r1.status());
        log.info("b1={}", b1.status());
        log.info("r2={}", r2.status());
        log.info("b2={}", b2.status());
    }
}
```
